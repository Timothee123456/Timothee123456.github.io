<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz - L'entre deux guerres</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE'
                    }
                }
            }
        }
    </script>
    <style>
        .question-enter {
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        .correct {
            background-color: #10b981 !important;
            border-color: #10b981 !important;
            color: white !important;
        }
        .incorrect {
            background-color: #ef4444 !important;
            border-color: #ef4444 !important;
            color: white !important;
        }
        .disabled {
            pointer-events: none;
            opacity: 0.6;
        }
    </style>
</head>
<body class="bg-white dark:bg-[#181818] text-gray-900 dark:text-gray-100 min-h-screen transition-colors">
    <div class="container mx-auto px-4 py-8 max-w-3xl">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold mb-2 text-primary">Quiz - L'entre deux guerres</h1>
            <p class="text-gray-600 dark:text-gray-400 text-base">Testez vos connaissances sur l'entre deux guerres</p>
        </div>

        <!-- Start Screen -->
        <div id="startScreen" class="bg-gray-50 dark:bg-gray-800 rounded-lg shadow-lg p-8 text-center">
            <div class="mb-6">
                <svg class="w-20 h-20 mx-auto text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"/>
                </svg>
            </div>
            <h2 class="text-2xl font-bold mb-4">Pr√™t √† commencer ?</h2>
            <p class="text-gray-600 dark:text-gray-400 mb-6 text-base">Ce quiz contient 30 questions sur l'entre deux guerres</p>
            <button onclick="startQuiz()" class="bg-primary hover:bg-opacity-90 text-white font-semibold py-3 px-8 rounded-lg transition-all transform hover:scale-105 text-base">
                Commencer le quiz
            </button>
            <div class="mt-6 text-sm text-gray-500 dark:text-gray-400">
                <p class="mb-2">‚å®Ô∏è Raccourcis clavier :</p>
                <p><kbd class="px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded text-xs">Entr√©e</kbd> pour commencer</p>
            </div>
        </div>

        <!-- Quiz Screen -->
        <div id="quizScreen" class="hidden">
            <!-- Progress Bar -->
            <div class="mb-6">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm text-gray-600 dark:text-gray-400">Question <span id="currentQuestion">1</span> / <span id="totalQuestions">18</span></span>
                    <span class="text-sm font-semibold text-primary"><span id="score">0</span> points</span>
                </div>
                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5">
                    <div id="progressBar" class="bg-primary h-2.5 rounded-full transition-all duration-300" style="width: 0%"></div>
                </div>
            </div>

            <!-- Question Card -->
            <div class="bg-gray-50 dark:bg-gray-800 rounded-lg shadow-lg p-6 md:p-8 mb-6 question-enter">
                <h3 id="questionText" class="text-xl md:text-2xl font-bold mb-6 text-gray-900 dark:text-gray-100"></h3>
                <div id="answersContainer" class="space-y-3"></div>
            </div>

            <!-- Feedback -->
            <div id="feedback" class="hidden mb-6 p-4 rounded-lg">
                <p id="feedbackText" class="font-semibold text-base"></p>
                <p id="explanationText" class="mt-2 text-sm"></p>
            </div>

            <!-- Next Button -->
            <div class="text-center">
                <button id="nextBtn" onclick="nextQuestion()" class="hidden bg-primary hover:bg-opacity-90 text-white font-semibold py-3 px-8 rounded-lg transition-all text-base">
                    Question suivante ‚Üí
                </button>
                <div class="mt-4 text-sm text-gray-500 dark:text-gray-400">
                    <p>‚å®Ô∏è Raccourcis :
                        <span id="quizShortcuts">
                            <kbd class="px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded text-xs">A-D</kbd> ou
                            <kbd class="px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded text-xs">1-4</kbd> pour r√©pondre ‚Ä¢
                        </span>
                        <kbd class="px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded text-xs">Entr√©e</kbd> pour valider/continuer
                    </p>
                </div>
            </div>
        </div>

        <!-- Results Screen -->
        <div id="resultsScreen" class="hidden">
            <div class="bg-gray-50 dark:bg-gray-800 rounded-lg shadow-lg p-8 text-center">
                <div class="mb-6">
                    <svg id="resultIcon" class="w-24 h-24 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                </div>
                <h2 class="text-3xl font-bold mb-4">Quiz termin√© !</h2>
                <p class="text-xl mb-2">Votre score :</p>
                <p id="finalScore" class="text-5xl font-bold text-primary mb-6">0/18</p>
                <p id="resultMessage" class="text-gray-600 dark:text-gray-400 mb-8 text-base"></p>

                <!-- Score Details -->
                <div class="bg-white dark:bg-gray-700 rounded-lg p-6 mb-6">
                    <h3 class="font-semibold mb-4 text-lg">D√©tails</h3>
                    <div class="grid grid-cols-3 gap-4 text-center">
                        <div>
                            <p class="text-2xl font-bold text-green-500" id="correctCount">0</p>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Correctes</p>
                        </div>
                        <div>
                            <p class="text-2xl font-bold text-red-500" id="incorrectCount">0</p>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Incorrectes</p>
                        </div>
                        <div>
                            <p class="text-2xl font-bold text-primary" id="percentageScore">0%</p>
                            <p class="text-sm text-gray-600 dark:text-gray-400">R√©ussite</p>
                        </div>
                    </div>
                </div>

                <!-- Section des erreurs -->
                <div id="mistakesSection" class="mt-6"></div>

                <button onclick="restartQuiz()" class="bg-primary hover:bg-opacity-90 text-white font-semibold py-3 px-8 rounded-lg transition-all transform hover:scale-105 text-base">
                    Recommencer le quiz
                </button>
                <div class="mt-4 text-sm text-gray-500 dark:text-gray-400">
                    <p>‚å®Ô∏è <kbd class="px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded text-xs">Entr√©e</kbd> pour recommencer</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dark mode detection
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // Quiz data
        const quizData = [
  {
    "question": "Quelle institution internationale est cr√©√©e au lendemain de la Premi√®re Guerre mondiale dans une volont√© d'en finir avec la guerre par le droit ?",
    "type": "multiple-choice",
    "answers": [
      "L'Organisation des Nations Unies (ONU)",
      "Le Fonds Mon√©taire International (FMI)",
      "La Soci√©t√© des Nations (SDN)",
      "La Cour Internationale de Justice"
    ],
    "correct": 2,
    "explanation": "Au lendemain de la Premi√®re Guerre mondiale, la Soci√©t√© des Nations (SDN) est cr√©√©e dans la volont√© d'en finir avec la guerre par le droit."
  },
  {
    "question": "Quel √©v√©nement majeur aux √âtats-Unis en 1929 est identifi√© comme le d√©but de la crise √©conomique mondiale des ann√©es 30 ?",
    "type": "multiple-choice",
    "answers": [
      "L'√©lection de Franklin D. Roosevelt",
      "Le Krach Boursier (Jeudi noir)",
      "La Grande D√©pression",
      "La faillite de la Banque f√©d√©rale"
    ],
    "correct": 1,
    "explanation": "Le d√©but des ann√©es 30 est marqu√© par une crise √©conomique mondiale, initi√©e par le krach boursier, appel√© 'Jeudi noir 1929', aux √âtats-Unis."
  },
  {
    "question": "Selon la d√©finition donn√©e dans la le√ßon, un r√©gime totalitaire est une dictature qui contr√¥le l'ensemble de la soci√©t√© au moyen d'un parti unique, de la terreur, de la propagande, d'un contr√¥le de l'√©conomie, d'une id√©ologie, et de quel autre √©l√©ment ?",
    "type": "multiple-choice",
    "answers": [
      "L'abolition de la peine de mort",
      "La fabrique d'un homme nouveau",
      "Le pluralisme politique",
      "La s√©paration des pouvoirs"
    ],
    "correct": 1,
    "explanation": "Un r√©gime totalitaire contr√¥le l'ensemble de la soci√©t√©, notamment par la 'fabrique d'un homme nouveau'."
  },
  {
    "question": "L√©nine, chef du parti communiste de Russie, a mis en place une dictature car le r√©gime bolchevik √©tait menac√© par quelle situation ?",
    "type": "multiple-choice",
    "answers": [
      "L'invasion √©trang√®re",
      "La guerre civile (Blancs contre Rouges)",
      "La Grande Famine",
      "Le m√©contentement des Koulaks"
    ],
    "correct": 1,
    "explanation": "L√©nine cherche √† imposer l'autorit√© des Bolcheviks en mettant en place une dictature car le r√©gime est menac√© par la guerre civile (Blancs contre les Rouges) depuis la prise violente d'octobre 1917."
  },
  {
    "question": "Quel poste Staline occupait-il √† l'√©poque de L√©nine qui lui a permis de s'imposer comme son h√©ritier et de prendre le pouvoir en URSS ?",
    "type": "multiple-choice",
    "answers": [
      "Chef de l'Arm√©e Rouge",
      "Commissaire du peuple √† la d√©fense",
      "Secr√©taire g√©n√©ral du parti",
      "Pr√©sident du Soviet Supr√™me"
    ],
    "correct": 2,
    "explanation": "Staline √©tait Secr√©taire g√©n√©ral du parti, ce qui lui a permis de s'imposer comme dirigeant de l'URSS apr√®s la mort de L√©nine en 1924."
  },
  {
    "question": "Quel √©tait le but principal du premier plan quinquennal en URSS, mis en place par Staline √† partir de 1929 ?",
    "type": "multiple-choice",
    "answers": [
      "√âtablir une soci√©t√© de consommation",
      "Former l'URSS en un pays industriel puissant",
      "Am√©liorer le niveau de vie des paysans",
      "Diffuser la r√©volution mondiale"
    ],
    "correct": 1,
    "explanation": "Les objectifs du 1er plan quinquennal √©taient de 'former l'URSS en un pays industriel puissant' et de transformer l'URSS."
  },
  {
    "question": "Qui √©taient les \"Koulaks\" en URSS sous Staline, et quel sort leur √©tait-il r√©serv√© ?",
    "type": "multiple-choice",
    "answers": [
      "Les soldats de l'Arm√©e Rouge ; ils √©taient encadr√©s par le Parti",
      "Les intellectuels ; ils √©taient encourag√©s par la propagande",
      "Les paysans ais√©s ; ils √©taient liquid√©s ou exp√©di√©s au Goulag",
      "Les membres du Parti communiste ; ils √©taient promus"
    ],
    "correct": 2,
    "explanation": "Les Koulaks (paysans ais√©s) sont les premi√®res victimes de la r√©pression stalinienne : ils sont liquid√©s ou exp√©di√©s dans des camps de concentration (Goulag)."
  },
  {
    "question": "Quel est le nom donn√© aux grandes fermes collectives dans lesquelles Staline obligeait les paysans √† entrer pour collectiviser l'agriculture ?",
    "type": "multiple-choice",
    "answers": [
      "Les Soviets",
      "Les Goulags",
      "Les Kolkhozes",
      "Les Sovkhozes"
    ],
    "correct": 2,
    "explanation": "Staline oblige les paysans √† entrer dans des grandes fermes collectives, appel√©es les kolkhozes."
  },
  {
    "question": "La p√©riode de la \"Grande Terreur\" en URSS, marqu√©e par une grande purge au sein m√™me du parti communiste, s'est √©tendue sur quelles ann√©es ?",
    "type": "multiple-choice",
    "answers": [
      "1917-1924",
      "1929-1933",
      "1936-1939",
      "1941-1945"
    ],
    "correct": 2,
    "explanation": "La Grande Terreur, durant laquelle Staline organise une grande purge, s'est d√©roul√©e de 1936 √† 1939."
  },
  {
    "question": "Selon la le√ßon, comment Staline √©tait-il couramment surnomm√©, renfor√ßant son culte de la personnalit√© ?",
    "type": "multiple-choice",
    "answers": [
      "Le P√®re du Peuple",
      "L'homme de fer",
      "L'homme d'acier",
      "Le Petit Timonier"
    ],
    "correct": 2,
    "explanation": "Staline √©tait surnomm√© 'l'homme d'acier'."
  },
  {
    "question": "Adolf Hitler, apr√®s son coup d'√âtat manqu√© en 1923, a r√©dig√© son livre qui expose son antis√©mitisme et son projet pour l'Allemagne. Quel est le titre de cet ouvrage ?",
    "type": "multiple-choice",
    "answers": [
      "Unser Kampf",
      "Mein F√ºhrer",
      "Mein Kampf",
      "Deutschland √ºber alles"
    ],
    "correct": 2,
    "explanation": "Hitler a r√©dig√© son volumineux Mein Kampf (Mon combat) en prison apr√®s le coup d'√âtat manqu√© de 1923, exposant son antis√©mitisme et son projet pour l'Allemagne."
  },
  {
    "question": "En quelle ann√©e Adolf Hitler est-il nomm√© Chancelier (chef du gouvernement) par le pr√©sident Hindenburg, acc√©dant ainsi au pouvoir par la voie d√©mocratique ?",
    "type": "multiple-choice",
    "answers": [
      "1923",
      "1930",
      "1933",
      "1934"
    ],
    "correct": 2,
    "explanation": "Hitler est nomm√© chancelier par le pr√©sident Hindenburg le 30 janvier 1933, acc√©dant ainsi au pouvoir d√©mocratiquement."
  },
  {
    "question": "Quel est le nom de la police politique nazie charg√©e d'arr√™ter les opposants (comme les communistes) et de les envoyer dans des camps de concentration ?",
    "type": "multiple-choice",
    "answers": [
      "Le NKVD",
      "Le Komintern",
      "La Gestapo",
      "La SS"
    ],
    "correct": 2,
    "explanation": "Les opposants politiques, comme les communistes, sont arr√™t√©s par la police politique (Gestapo) et les SS puis envoy√©s dans des camps de concentration."
  },
  {
    "question": "Les lois antis√©mites de Nuremberg, interdisant notamment aux Allemands et aux Juifs de se marier pour \"√©viter de souiller le sang aryen\", ont √©t√© promulgu√©es en quelle ann√©e ?",
    "type": "multiple-choice",
    "answers": [
      "1933",
      "1935",
      "1938",
      "1939"
    ],
    "correct": 1,
    "explanation": "Les Lois antis√©mites de Nuremberg ont √©t√© promulgu√©es en 1935."
  },
  {
    "question": "Quelle est la devise nazie, r√©sumant l'id√©al d'unit√© sous un chef unique ?",
    "type": "multiple-choice",
    "answers": [
      "Travail, Famille, Patrie",
      "Ein Volk, Ein Reich, Ein F√ºhrer",
      "Deutschland Erwache",
      "Proletarier aller L√§nder, vereinigt euch!"
    ],
    "correct": 1,
    "explanation": "La devise nazie est : 'Ein volk, ein reich, ein fuhrer' (un peuple, un territoire, un chef)."
  },
  {
    "question": "Quel concept, cher √† Hitler, repr√©sente la n√©cessit√© de conqu√©rir des territoires √† l'Est pour loger toute personne parlant allemand ?",
    "type": "multiple-choice",
    "answers": [
      "La Grande Allemagne",
      "L'Espace vital (Lebensraum)",
      "L'Autodaf√©",
      "Le Pangermanisme"
    ],
    "correct": 1,
    "explanation": "Hitler annonce ouvertement vouloir r√©cup√©rer ¬´ l'espace vital ¬ª (Lebensraum) des Allemands, consid√©rant que toute personne parlant allemand doit habiter dans ce 'reich'."
  },
  {
    "question": "Quel terme est utilis√© pour d√©signer l'annexion de l'Autriche par Hitler en mars 1938, en accord avec l'id√©e d'un \"reich\" ?",
    "type": "multiple-choice",
    "answers": [
      "La Nuit des Longs Couteaux",
      "Le Putsch de la Brasserie",
      "L'Anschluss",
      "La Conf√©rence de Munich"
    ],
    "correct": 2,
    "explanation": "L'annexion de l'Autriche en mars 1938 est appel√©e l'Anschluss."
  },
  {
    "question": "Quelle organisation nazie √©tait charg√©e de l'embrigadement de la jeunesse allemande afin de faire d'eux des \"purs nazis\" ?",
    "type": "multiple-choice",
    "answers": [
      "Le Komsomol",
      "La SA",
      "La Hitlerjugend",
      "Le Front du travail"
    ],
    "correct": 2,
    "explanation": "Les organisations nazies qui embrigadent la jeunesse sont notamment la Hitlerjugend (Jeunesses hitl√©riennes)."
  },
  {
    "question": "Quel √©v√©nement, marqu√© par un v√©ritable pogrom contre les Juifs, a eu lieu les 9 et 10 novembre 1938, intensifiant la violence d'√âtat ?",
    "type": "multiple-choice",
    "answers": [
      "Le Putsch de Munich",
      "L'Autodaf√© des livres",
      "La Nuit de Cristal",
      "L'instauration des lois de Nuremberg"
    ],
    "correct": 2,
    "explanation": "La Nuit de Cristal, les 9 et 10 novembre 1938, marque un v√©ritable pogrom contre les Juifs, intensifiant la violence d'√âtat."
  },
  {
    "question": "Quel groupe de personnes, en plus des Juifs et opposants politiques, est mentionn√© comme √©tant pers√©cut√© par le r√©gime nazi car il √©tait accus√© d'affaiblir la race aryenne ?",
    "type": "multiple-choice",
    "answers": [
      "Les Catholiques",
      "Les Slaves orientaux",
      "Les Homosexuels et les handicap√©s",
      "Les T√©moins de J√©hovah"
    ],
    "correct": 2,
    "explanation": "Les homosexuels et les handicap√©s, accus√©s d'affaiblir la race, sont pers√©cut√©s par le r√©gime nazi, au m√™me titre que les Juifs et les Tsiganes."
  },
  {
    "question": "Les livres qui d√©plaisaient au r√©gime nazi √©taient br√ªl√©s en public. Comment s'appelle cette action de destruction des ouvrages ?",
    "type": "multiple-choice",
    "answers": [
      "Un autodaf√©",
      "Un pogrom",
      "Une purge",
      "Un Holocauste"
    ],
    "correct": 0,
    "explanation": "Les livres qui d√©plaisent sont br√ªl√©s (autodaf√©s) par le r√©gime nazi."
  },
  {
    "question": "Quels sont les trois partis qui formaient la coalition du Front populaire, victorieuse aux √©lections de mai 1936 en France ?",
    "type": "multiple-choice",
    "answers": [
      "Parti conservateur, Parti lib√©ral, Parti r√©publicain",
      "PCF (communistes), SFIO (socialistes), Radicaux",
      "Les ligues d'extr√™me droite",
      "Les Centristes"
    ],
    "correct": 1,
    "explanation": "La coalition du Front populaire √©tait compos√©e du PCF (communistes), de la SFIO (socialistes) et des Radicaux."
  },
  {
    "question": "Quel acquis social majeur a √©t√© √©tabli par les Accords Matignon de juin 1936 en faveur des ouvriers ?",
    "type": "multiple-choice",
    "answers": [
      "La retraite √† 60 ans",
      "La semaine de 40 heures et deux semaines de cong√©s pay√©s",
      "Le droit de gr√®ve illimit√©",
      "L'abolition de la propri√©t√© priv√©e"
    ],
    "correct": 1,
    "explanation": "Les Accords Matignon ont notamment cr√©√© la semaine de 40 heures et deux semaines de cong√©s pay√©s annuels pour les ouvriers."
  },
  {
    "question": "Quel √©tait l'effet principal de la victoire du Front Populaire en France en 1936 concernant l'installation du totalitarisme ?",
    "type": "multiple-choice",
    "answers": [
      "Elle a provoqu√© un coup d'√âtat militaire",
      "Elle a favoris√© l'installation d'un r√©gime fasciste",
      "Elle a permis √† la France de rester une d√©mocratie",
      "Elle a provoqu√© une guerre civile"
    ],
    "correct": 2,
    "explanation": "Malgr√© la crise √©conomique et la mont√©e des mouvements fascistes, la victoire du Front Populaire a permis √† la France de rester une d√©mocratie."
  },
  {
    "question": "Quel pourcentage du budget allemand repr√©sentait l'industrie d'armement en 1938, t√©moignant de la violation du trait√© de Versailles ?",
    "type": "multiple-choice",
    "answers": [
      "55 %",
      "85 %",
      "54 %",
      "74 %"
    ],
    "correct": 3,
    "explanation": "L'industrie d'armement repr√©sentait 74 % du budget allemand en 1938, une illustration du r√©armement et de la violation du trait√© de Versailles par Hitler."
  },
  {
    "question": "Lors de la Conf√©rence de Munich en 1938, quelles r√©gions Hitler a-t-il pu annexer (avec l'accord de la France et de l'Angleterre qui c√©daient √† la paix) ?",
    "type": "multiple-choice",
    "answers": [
      "L'Alsace-Lorraine",
      "La Rh√©nanie",
      "Les Sud√®tes",
      "La Ruhr"
    ],
    "correct": 2,
    "explanation": "√Ä la conf√©rence de Munich, la France et l'Angleterre ont c√©d√© √† l'Allemagne les Sud√®tes."
  },
  {
    "question": "Qui √©tait le chef nationaliste qui a men√© le coup d'√âtat en Espagne en 1936 contre le Front Populaire r√©publicain, d√©clenchant la guerre civile ?",
    "type": "multiple-choice",
    "answers": [
      "Juan Negr√≠n",
      "Francisco Franco",
      "Emiliano Zapata",
      "Primo de Rivera"
    ],
    "correct": 1,
    "explanation": "La guerre civile espagnole a √©t√© d√©clench√©e par le coup d'√âtat du g√©n√©ral Francisco Franco (nationaliste) contre le Front Populaire r√©publicain en 1936."
  },
  {
    "question": "Dans la Guerre d'Espagne (1936-1939), les r√©gimes totalitaires (Allemagne et Italie) sont intervenus militairement pour soutenir quel camp ?",
    "type": "multiple-choice",
    "answers": [
      "Les R√©publicains (Front Populaire)",
      "Les Nationalistes (Franquistes)",
      "Les Brigades Internationales",
      "Les Anarchistes"
    ],
    "correct": 1,
    "explanation": "Les r√©gimes totalitaires (Allemagne et Italie) ont soutenu les Nationalistes (Franquistes) men√©s par Franco."
  },
  {
    "question": "Selon la d√©claration du pr√©sident de la R√©publique espagnole Juan Negr√≠n en 1938, l'intervention des √âtats fascistes dans la Guerre d'Espagne visait √† obtenir quoi en √©change de l'√©crasement du peuple espagnol ?",
    "type": "multiple-choice",
    "answers": [
      "Des richesses mini√®res",
      "Des bases navales",
      "Des positions strat√©giques de valeur",
      "Des accords commerciaux"
    ],
    "correct": 2,
    "explanation": "L'Italie et l'Allemagne sont intervenues pour obtenir 'en √©change de l'√©crasement du peuple espagnol, des positions strat√©giques de valeur'."
  },
  {
    "question": "Par quel √©v√©nement et √† quelle date la Seconde Guerre mondiale est-elle d√©clench√©e ?",
    "type": "multiple-choice",
    "answers": [
      "L'annexion des Sud√®tes (1938)",
      "L'invasion de la Pologne (1939)",
      "La Conf√©rence de Munich (1938)",
      "L'entr√©e de l'Italie dans l'Axe (1939)"
    ],
    "correct": 1,
    "explanation": "Le d√©clenchement de la Seconde Guerre mondiale est l'invasion de la Pologne le 1er septembre 1939."
  }
]

        let currentQuestionIndex = 0;
        let score = 0;
        let correctAnswers = 0;
        let incorrectAnswers = 0;
        let answered = false;
        let userAnswers = []; // Stocker les r√©ponses de l'√©l√®ve
        let currentShuffledAnswers = []; // Stores the shuffled answers for the current question, with their original indices

        /**
         * Shuffles an array in place using the Fisher-Yates (Knuth) algorithm.
         * @param {Array} array The array to shuffle.
         */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]]; // Swap elements
            }
        }

        /**
         * Normalizes a text answer for comparison (lowercase, trim, single spaces, simplified date parts).
         * @param {string} text The text to normalize.
         * @returns {string} The normalized text.
         */
        function normalizeTextAnswer(text) {
            // Convert to lowercase, trim whitespace
            // Replace common date separators with space
            // Replace multiple spaces with single space
            // Remove "er", "√®re", "√®me", "e" after a digit (e.g., "1er mai" -> "1 mai")
            return text.toLowerCase().trim()
                       .replace(/(\d)\s*(er|√®re|√®me|e)\s*/g, '$1 ') // "1er mai" -> "1 mai"
                       .replace(/[\.,\-\/]/g, ' ') // Replace punctuation with space
                       .replace(/\s+/g, ' '); // Replace multiple spaces with single space
        }

        function startQuiz() {
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('quizScreen').classList.remove('hidden');
            currentQuestionIndex = 0;
            score = 0;
            correctAnswers = 0;
            incorrectAnswers = 0;
            answered = false;
            userAnswers = []; // R√©initialiser les r√©ponses
            displayQuestion();
        }

        function displayQuestion() {
            answered = false;
            const question = quizData[currentQuestionIndex];

            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            document.getElementById('totalQuestions').textContent = quizData.length;
            document.getElementById('questionText').textContent = question.question;
            document.getElementById('feedback').classList.add('hidden');
            document.getElementById('nextBtn').classList.add('hidden');

            // Update progress bar
            const progress = ((currentQuestionIndex) / quizData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';

            const answersContainer = document.getElementById('answersContainer');
            answersContainer.innerHTML = ''; // Clear previous answers

            // Update keyboard shortcuts display
            const quizShortcuts = document.getElementById('quizShortcuts');
            if (question.type === 'text') {
                quizShortcuts.classList.add('hidden');
            } else {
                quizShortcuts.classList.remove('hidden');
            }

            if (question.type === 'text') {
                // Display text input field
                const input = document.createElement('input');
                input.type = 'text';
                input.id = 'textAnswerInput';
                input.placeholder = 'Votre r√©ponse...';
                input.className = 'w-full p-4 rounded-lg border-2 border-gray-300 dark:border-gray-600 focus:border-primary focus:ring-primary focus:ring-1 outline-none transition-all text-base bg-white dark:bg-gray-800';
                answersContainer.appendChild(input);

                const submitButton = document.createElement('button');
                submitButton.id = 'submitTextBtn';
                submitButton.className = 'w-full mt-3 bg-primary hover:bg-opacity-90 text-white font-semibold py-3 px-8 rounded-lg transition-all text-base';
                submitButton.textContent = 'Valider la r√©ponse';
                submitButton.onclick = () => handleAnswerSubmission();
                answersContainer.appendChild(submitButton);

                input.focus(); // Focus the input field
            } else {
                // Display multiple-choice buttons
                const answersWithOriginalIndex = question.answers.map((text, originalIndex) => ({ text, originalIndex }));
                
                shuffleArray(answersWithOriginalIndex);
                currentShuffledAnswers = answersWithOriginalIndex; // Store for later use in handleAnswerSubmission

                currentShuffledAnswers.forEach((answerObj, shuffledIndex) => {
                    const button = document.createElement('button');
                    button.className = 'w-full text-left p-4 rounded-lg border-2 border-gray-300 dark:border-gray-600 hover:border-primary hover:bg-gray-100 dark:hover:bg-gray-700 transition-all text-base bg-white dark:bg-gray-800';
                    button.innerHTML = `<span class="font-semibold">${String.fromCharCode(65 + shuffledIndex)}.</span> ${answerObj.text}`;
                    button.onclick = () => handleAnswerSubmission(shuffledIndex); // Pass the shuffled index
                    answersContainer.appendChild(button);
                });
            }
        }

        function handleAnswerSubmission(selectedShuffledIndex = null) {
            if (answered) return; // Prevent double submission
            answered = true;

            const question = quizData[currentQuestionIndex];
            const feedback = document.getElementById('feedback');
            const feedbackText = document.getElementById('feedbackText');
            const explanationText = document.getElementById('explanationText');

            let isCorrect = false;
            let userAnswerDisplay = ''; // To show user's input in results
            let correctAnswerDisplay = ''; // To show correct answer in results

            if (question.type === 'text') {
                const textInput = document.getElementById('textAnswerInput');
                const userInputValue = textInput.value;
                userAnswerDisplay = userInputValue; // Store raw input for display
                const normalizedUserInput = normalizeTextAnswer(userInputValue);
                
                // Check if normalized user input matches any of the correct answers
                isCorrect = question.correct.some(correctStr => normalizeTextAnswer(correctStr) === normalizedUserInput);
                correctAnswerDisplay = question.correct[0]; // Use the first correct answer for display

                // Disable input and button
                textInput.disabled = true;
                document.getElementById('submitTextBtn').disabled = true;

            } else { // Multiple-choice
                const buttons = document.getElementById('answersContainer').children;
                const selectedAnswerOriginalIndex = currentShuffledAnswers[selectedShuffledIndex].originalIndex;
                const correctAnswerOriginalIndex = question.correct;
                
                isCorrect = (selectedAnswerOriginalIndex === correctAnswerOriginalIndex);
                userAnswerDisplay = question.answers[selectedAnswerOriginalIndex]; // Store MC text for display
                correctAnswerDisplay = question.answers[correctAnswerOriginalIndex];

                // Disable all MC buttons
                for (let btn of buttons) {
                    btn.classList.add('disabled');
                }

                // Highlight correct/incorrect MC buttons
                if (isCorrect) {
                    buttons[selectedShuffledIndex].classList.add('correct');
                } else {
                    buttons[selectedShuffledIndex].classList.add('incorrect');
                    const correctButtonShuffledIndex = currentShuffledAnswers.findIndex(
                        ans => ans.originalIndex === correctAnswerOriginalIndex
                    );
                    if (correctButtonShuffledIndex !== -1) {
                        buttons[correctButtonShuffledIndex].classList.add('correct');
                    }
                }
            }

            // Common feedback logic
            if (isCorrect) {
                score++;
                correctAnswers++;
                feedbackText.textContent = '‚úì Correct !';
                feedbackText.className = 'font-semibold text-green-600 dark:text-green-400 text-base';
                feedback.className = 'mb-6 p-4 rounded-lg bg-green-50 dark:bg-green-900/30 border-2 border-green-500';
            } else {
                incorrectAnswers++;
                feedbackText.textContent = '‚úó Incorrect';
                feedbackText.className = 'font-semibold text-red-600 dark:text-red-400 text-base';
                feedback.className = 'mb-6 p-4 rounded-lg bg-red-50 dark:bg-red-900/30 border-2 border-red-500';
            }

            explanationText.textContent = question.explanation;
            explanationText.className = 'mt-2 text-sm text-gray-700 dark:text-gray-300';
            feedback.classList.remove('hidden');

            document.getElementById('score').textContent = score;
            document.getElementById('nextBtn').classList.remove('hidden');

            // Store user's answer for results screen
            userAnswers.push({
                questionIndex: currentQuestionIndex,
                userAnswer: userAnswerDisplay,
                correctAnswer: correctAnswerDisplay,
                isCorrect: isCorrect,
                questionType: question.type
            });
        }

        function nextQuestion() {
            currentQuestionIndex++;

            if (currentQuestionIndex < quizData.length) {
                displayQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            document.getElementById('quizScreen').classList.add('hidden');
            document.getElementById('resultsScreen').classList.remove('hidden');

            const percentage = Math.round((score / quizData.length) * 100);

            document.getElementById('finalScore').textContent = `${score}/${quizData.length}`;
            document.getElementById('correctCount').textContent = correctAnswers;
            document.getElementById('incorrectCount').textContent = incorrectAnswers;
            document.getElementById('percentageScore').textContent = percentage + '%';

            // Result message
            let message = '';
            const resultIcon = document.getElementById('resultIcon');

            if (percentage >= 90) {
                message = 'Excellent ! Vous ma√Ætrisez parfaitement les fondements de la R√©publique et de la Citoyennet√© ! üéâ';
                resultIcon.className = 'w-24 h-24 mx-auto text-green-500';
            } else if (percentage >= 70) {
                message = 'Tr√®s bien ! Vous avez de bonnes connaissances sur le sujet. üëç';
                resultIcon.className = 'w-24 h-24 mx-auto text-blue-500';
            } else if (percentage >= 50) {
                message = 'Pas mal ! Continuez √† r√©viser pour am√©liorer votre score. üìö';
                resultIcon.className = 'w-24 h-24 mx-auto text-yellow-500';
            } else {
                message = 'Continuez vos r√©visions ! Relisez la fiche et r√©essayez. üí™';
                resultIcon.className = 'w-24 h-24 mx-auto text-red-500';
            }

            document.getElementById('resultMessage').textContent = message;

            // Afficher les erreurs de l'√©l√®ve
            displayMistakes();
        }

        function displayMistakes() {
            const mistakesSection = document.getElementById('mistakesSection');
            const mistakes = userAnswers.filter(answer => !answer.isCorrect);

            if (mistakes.length === 0) {
                mistakesSection.innerHTML = `
                    <div class="bg-green-50 dark:bg-green-900/30 border-2 border-green-500 rounded-lg p-6">
                        <h3 class="text-xl font-bold text-green-600 dark:text-green-400 mb-2">üéâ Parfait !</h3>
                        <p class="text-gray-700 dark:text-gray-300 text-base">Vous n'avez fait aucune erreur ! F√©licitations !</p>
                    </div>
                `;
                return;
            }

            let html = `
                <div class="bg-white dark:bg-gray-700 rounded-lg p-6 text-left">
                    <h3 class="text-xl font-bold mb-4 text-red-500">üìã Vos erreurs (${mistakes.length})</h3>
                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">Voici les questions o√π vous vous √™tes tromp√©(e) :</p>
                    <div class="space-y-4">
            `;

            mistakes.forEach((mistake, index) => {
                const question = quizData[mistake.questionIndex];
                html += `
                    <div class="border-l-4 border-red-500 bg-red-50 dark:bg-red-900/20 p-4 rounded">
                        <p class="font-semibold text-gray-900 dark:text-gray-100 mb-2">
                            <span class="text-red-500">Question ${mistake.questionIndex + 1}:</span> ${question.question}
                        </p>
                        <div class="ml-4 space-y-1 text-sm">
                            <p class="text-red-600 dark:text-red-400">
                                ‚úó <span class="font-medium">Votre r√©ponse :</span> ${mistake.userAnswer || '[Non r√©pondu]'}
                            </p>
                            <p class="text-green-600 dark:text-green-400">
                                ‚úì <span class="font-medium">Bonne r√©ponse :</span> ${mistake.correctAnswer}
                            </p>
                            <p class="text-gray-600 dark:text-gray-400 italic mt-2">
                                üí° ${question.explanation}
                            </p>
                        </div>
                    </div>
                `;
            });

            html += `
                    </div>
                </div>
            `;

            mistakesSection.innerHTML = html;
        }

        function restartQuiz() {
            document.getElementById('resultsScreen').classList.add('hidden');
            document.getElementById('startScreen').classList.remove('hidden');
        }

        // Gestion des touches clavier
        document.addEventListener('keydown', (event) => {
            const key = event.key.toLowerCase();
            const quizScreen = document.getElementById('quizScreen');
            const startScreen = document.getElementById('startScreen');
            const resultsScreen = document.getElementById('resultsScreen');

            // Enter pour commencer, suivant, ou recommencer
            if (key === 'enter') {
                if (!startScreen.classList.contains('hidden')) {
                    startQuiz();
                    event.preventDefault();
                } else if (!quizScreen.classList.contains('hidden')) {
                    const question = quizData[currentQuestionIndex];
                    if (answered) { // Already answered, move to next
                        nextQuestion();
                    } else if (question.type === 'text') { // Text question, not answered, submit
                        handleAnswerSubmission();
                    }
                    event.preventDefault();
                } else if (!resultsScreen.classList.contains('hidden')) {
                    restartQuiz();
                    event.preventDefault();
                }
            }

            // Touches 1-4 ou A-D pour s√©lectionner une r√©ponse (seulement pour MC et si pas encore r√©pondu)
            if (!quizScreen.classList.contains('hidden') && !answered) {
                const question = quizData[currentQuestionIndex];
                if (question.type !== 'text') {
                    let answerIndex = -1; // This will be the shuffled index

                    // Touches num√©riques 1-4
                    if (key >= '1' && key <= '4') {
                        answerIndex = parseInt(key) - 1;
                    }
                    // Touches A-D
                    else if (key === 'a') answerIndex = 0;
                    else if (key === 'b') answerIndex = 1;
                    else if (key === 'c') answerIndex = 2;
                    else if (key === 'd') answerIndex = 3;

                    // Check if the selected index is valid for the current shuffled answers
                    if (answerIndex >= 0 && answerIndex < currentShuffledAnswers.length) {
                        handleAnswerSubmission(answerIndex);
                        event.preventDefault();
                    }
                }
            }
        });
    </script>
</body>
</html>
